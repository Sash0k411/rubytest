<% if notice.present? %>
  <p id="notice"><%= notice %></p>
<% end %>

<h1>Category: <%= @category.name %></h1>

<div class="container">
  <div class="row">
    <% cache @products do %>
      <% @items.each do |product| %>
        <% cache product do %>
          <div class="container bg-light rounded" style="width: 20rem;">
            <li class="list-group list-group-flush ">
              <%= image_tag(product.image_url, size: "150") %>
              <h2><%= product.title %></h2>
              <p class="list-group-item">
                <%= sanitize(product.description) %>
              </p>
              <p class="list-group-item">
                <%= link_to product.category.name, product %>
              </p>
              <div class="price list-group-item">
                <%= number_to_currency(product.price_with_discount) %>
              </div>
              <div class="card-footer">
                <%= button_to "Add to Cart", line_items_path(product_id: product),
                               class: 'btn btn-success active'%>

              </div>
            </li>
          </div>
        <% end %>
      <% end %>
    <% end %>
  </div>
</div>

<% if @current_user.try("admin?") %>
  <div class="form-control">
    <%= link_to 'Edit', edit_category_path(@category) %> |
    <%= link_to 'Back', categories_path %>
  </div>
<%end%>